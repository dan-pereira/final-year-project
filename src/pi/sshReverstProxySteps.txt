:l is the 'local' ec2 instance
:r is the 'remote' raspi

#check auto-ssh on pi with:
systemctl status autossh-tunnel.service

:l
sudo systemctl enable sshd
sudo systemctl start sshd

:r
ssh -R 5999:localhost:22 ubuntu@ec2-18-200-112-1.eu-west-1.compute.amazonaws.com

:l
localhost port 5999 will now be forwarded to port 22 of remote

:l
ssh pi@localhost -p5999

#note : tell if port is open
nc -z localhost 5999 || echo 'Pi SSH Tunnel not connected'

:r
set up auto ssh
/etc/systemd/system/autossh-tunnel.service

'''
[Unit]
Description=AutoSSH tunnel service Remote port 5999 to local 22
After=network.target
[Service]
Environment="AUTOSSH_GATETIME=0"
ExecStart=/usr/bin/autossh -o "ServerAliveInterval 10" -o "ServerAliveCountMax 3" -N -R 5999:localhost:22 ubuntu@ec2-18-200-112-1.eu-west-1.compute.amazonaws.com
[Install]
WantedBy=multi-user.target
'''
cp id_rsa to root
